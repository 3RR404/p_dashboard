function Hilitor(e,t){var i=document.getElementById(e)||document.body,n=t||"EM",o=new RegExp("^(?:"+n+"|SCRIPT|FORM|SPAN)$"),r=["#ff6","#a0ffff","#9f9","#f99","#f6f"],s=[],h=0,a="",l=!1,g=!1,d=new RegExp("^[^\\w]+|[^\\w]+$","g"),f=new RegExp("[^\\w'-]+","g");this.setMatchType=function(e){switch(e){case"left":this.openLeft=!1,this.openRight=!0;break;case"right":this.openLeft=!0,this.openRight=!1;break;case"open":this.openLeft=this.openRight=!0;break;default:this.openLeft=this.openRight=!1}},this.setRegex=function(e){if(e=e.replace(d,""),e=e.replace(f,"|"),e=e.replace(/^\||\|$/g,"")){var t="("+e+")";return this.openLeft||(t="\\b"+t),this.openRight||(t+="\\b"),a=new RegExp(t,"i"),!0}return!1},this.getRegex=function(){var e=a.toString();return e=e.replace(/(^\/(\\b)?|\(|\)|(\\b)?\/i$)/g,""),e=e.replace(/\|/g," ")},this.hiliteWords=function(e){if(void 0!==e&&e&&a&&!o.test(e.nodeName)){if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)this.hiliteWords(e.childNodes[t]);if(3==e.nodeType&&(nv=e.nodeValue)&&(regs=a.exec(nv))){s[regs[0].toLowerCase()]||(s[regs[0].toLowerCase()]=r[h++%r.length]);var i=document.createElement(n);i.appendChild(document.createTextNode(regs[0])),i.style.backgroundColor=s[regs[0].toLowerCase()],i.style.fontStyle="inherit",i.style.color="#000";var l=e.splitText(regs.index);l.nodeValue=l.nodeValue.substring(regs[0].length),e.parentNode.insertBefore(i,l)}}},this.remove=function(){for(var e=document.getElementsByTagName(n);e.length&&(el=e[0]);){var t=el.parentNode;t.replaceChild(el.firstChild,el),t.normalize()}},this.apply=function(e){this.remove(),void 0!==e&&e&&this.setRegex(e)&&this.hiliteWords(i)}}